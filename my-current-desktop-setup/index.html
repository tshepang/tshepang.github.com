<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Tshepang logs</title>

      <!-- CSS -->
      <link rel="stylesheet" href="http:&#x2F;&#x2F;tshepang.net&#x2F;print.css" media="print">
      <link rel="stylesheet" href="http:&#x2F;&#x2F;tshepang.net&#x2F;poole.css">
      <link rel="stylesheet" href="http:&#x2F;&#x2F;tshepang.net&#x2F;hyde.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

      
        <link rel="alternate" type="application/rss+xml" title="RSS" href="http:&#x2F;&#x2F;tshepang.net&#x2F;rss.xml">
      

      
      
    </head>

    <body class=" ">
        
            <div class="sidebar">
                <div class="container sidebar-sticky">
                    <div class="sidebar-about">
                        
                            <a href="http:&#x2F;&#x2F;tshepang.net"><h1>Tshepang logs</h1></a>
                            
                        
                    </div>

                    <ul class="sidebar-nav">
                        
                        
                        <li><a href="https:&#x2F;&#x2F;twitter.com&#x2F;tshepang_dev">twitter</a></li>
                        
                        <li><a href="https:&#x2F;&#x2F;github.com&#x2F;tshepang">github</a></li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div class="content container">
            
<div class="post">
  <h1 class="post-title">my current desktop setup</h1>
  <span class="post-date">2014-02-16</span>
  <p>Following is how my GUI environment is set-up on <a href="http://tshepang.net/sony-vaio-pro-13-svp13212sgbi">my home machine</a> (a
laptop) and work machine (a desktop). For the (libre) tools I frequently
use, see <a href="http://tshepang.net/floss-i-use-a-lot">this post</a> instead.</p>
<p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p>
<p>With recent Debian GNOME updates (late 2013), something got broken
enough that I could not login to my account. I saw this as a good
opportunity to finally try something other than GNOME as my primary
environment. I have before tinkered with other GUI environments (XFCE,
KDE 3, FluxBox, LXDE, and most recently, Window Maker), but none lasted
very long. But I think this time I will actually abandon GNOME
permanently, after nearly a decade of use.</p>
<p>I been playing with <a href="http://dwm.suckless.org">dwm</a> for the past several weeks, and the experience
has convinced me to stay. I am attracted to the philosophy of
minimalism, though I find they do take things a bit far in requiring
users to tinker with C source code in order to configure it. Luckily
it's not hard, and there's examples out there. It just takes a while
since there isn't a comprehensive guide I could find.</p>
<p>For my login manager, I use <a href="http://www.freedesktop.org/wiki/Software/LightDM">LightDM</a>. I added this line to its
configuration, in <code>[SeatDefaults]</code> section:</p>
<pre style="background-color:#2b303b">
<span style="color:#c0c5ce;">greeter-hide-users=false
</span></pre>
<p>It removes the need to manually enter my username each time I want to
login.</p>
<p>Reason I'm not using GDM? I wanted something light, which also
wouldn't pull in dozens of packages that I won't use. For example:</p>
<pre style="background-color:#2b303b">
<span style="color:#c0c5ce;">$ sudo apt-get install --no-install-recommends gdm3
</span><span style="color:#c0c5ce;">Reading package lists... Done
</span><span style="color:#c0c5ce;">Building dependency tree
</span><span style="color:#c0c5ce;">Reading state information... Done
</span><span style="color:#c0c5ce;">The following extra packages will be installed:
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">bluez dconf-cli evolution-data-server evolution-data-server-common
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-accountsservice-1.0 gir1.2-caribou-1.0 gir1.2-gck-1 gir1.2-gcr-3
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-gdesktopenums-3.0 gir1.2-gdm3 gir1.2-gkbd-3.0 gir1.2-gmenu-3.0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-gnomebluetooth-1.0 gir1.2-gnomedesktop-3.0 gir1.2-ibus-1.0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-mutter-3.0 gir1.2-nmgtk-1.0 gir1.2-polkit-1.0 gir1.2-soup-2.4
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-telepathyglib-0.12 gir1.2-telepathylogger-0.2 gir1.2-xkl-1.0 gjs
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gnome-bluetooth gnome-settings-daemon gnome-shell gnome-shell-common
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gnome-themes-standard gnome-themes-standard-data libbluetooth3 libcamel-1.2-43
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libcaribou-common libcaribou0 libebackend-1.2-6 libebook-1.2-14
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libebook-contacts-1.2-0 libecal-1.2-15 libedata-book-1.2-17 libedata-cal-1.2-20
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libedataserver-1.2-17 libgdata-common libgdata13 libgdm1 libgnome-menu-3-0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libgoa-1.0-0 libgoa-1.0-common libgweather-3-3 libgweather-common libibus-1.0-5
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libical0 libmission-control-plugins0 libmutter0b liboauth0 libopenobex1
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libpackagekit-glib2-16 libpulse-mainloop-glib0 librest-0.7-0 libsoup-gnome2.4-1
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libtelepathy-glib0 libtelepathy-logger3 libwacom-common libwacom2 mutter-common
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">obex-data-server obexd-client telepathy-mission-control-5
</span><span style="color:#c0c5ce;">Suggested packages:
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">evolution evolution-data-server-dbg gnome-orca gnome-user-share telepathy-haze
</span><span style="color:#c0c5ce;">Recommended packages:
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">zenity gvfs-backends gnome-control-center pulseaudio gkbd-capplet gnome-contacts
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gnome-user-guide gtk2-engines-pixbuf gnome-accessibility-themes packagekit
</span><span style="color:#c0c5ce;">The following NEW packages will be installed:
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">bluez dconf-cli evolution-data-server evolution-data-server-common gdm3
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-accountsservice-1.0 gir1.2-caribou-1.0 gir1.2-gck-1 gir1.2-gcr-3
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-gdesktopenums-3.0 gir1.2-gdm3 gir1.2-gkbd-3.0 gir1.2-gmenu-3.0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-gnomebluetooth-1.0 gir1.2-gnomedesktop-3.0 gir1.2-ibus-1.0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-mutter-3.0 gir1.2-nmgtk-1.0 gir1.2-polkit-1.0 gir1.2-soup-2.4
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gir1.2-telepathyglib-0.12 gir1.2-telepathylogger-0.2 gir1.2-xkl-1.0 gjs
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gnome-bluetooth gnome-settings-daemon gnome-shell gnome-shell-common
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">gnome-themes-standard gnome-themes-standard-data libbluetooth3 libcamel-1.2-43
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libcaribou-common libcaribou0 libebackend-1.2-6 libebook-1.2-14
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libebook-contacts-1.2-0 libecal-1.2-15 libedata-book-1.2-17 libedata-cal-1.2-20
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libedataserver-1.2-17 libgdata-common libgdata13 libgdm1 libgnome-menu-3-0
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libgoa-1.0-0 libgoa-1.0-common libgweather-3-3 libgweather-common libibus-1.0-5
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libical0 libmission-control-plugins0 libmutter0b liboauth0 libopenobex1
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libpackagekit-glib2-16 libpulse-mainloop-glib0 librest-0.7-0 libsoup-gnome2.4-1
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">libtelepathy-glib0 libtelepathy-logger3 libwacom-common libwacom2 mutter-common
</span><span style="color:#c0c5ce;">  </span><span style="color:#c0c5ce;">obex-data-server obexd-client telepathy-mission-control-5
</span><span style="color:#c0c5ce;">0 upgraded, 67 newly installed, 0 to remove and 45 not upgraded.
</span><span style="color:#c0c5ce;">Need to get 0 B/31.0 MB of archives.
</span><span style="color:#c0c5ce;">After this operation, 90.8 MB of additional disk space will be used.
</span></pre>
<p>GNOME philosophy tends towards tight integration, leading to things
being not as modular as I would like: how could a display manager end up
depending on a Contacts tool, or the Bluetooth stack. It may be just how
it was built in Debian, but that also means there were build options
that allowed such tight coupling in the first place. GDM has served me
well for years, but I'm not interested in all those tools it brings
with.</p>
<p>Anyways, enough with that. I added a custom <code>.desktop</code> file which will
become selectable on LightDM UI:</p>
<pre style="background-color:#2b303b">
<span style="color:#c0c5ce;">$ cat /usr/share/xsessions/custom.desktop
</span><span style="color:#c0c5ce;">[Desktop Entry]
</span><span style="color:#c0c5ce;">Name=Custom
</span><span style="color:#c0c5ce;">Exec=/etc/X11/Xsession
</span><span style="color:#c0c5ce;">Type=XSession
</span></pre>
<p>On selecting the entry labeled <strong>Custom</strong> that appears on LightDM, and
logging in, the following will get executed (<a href="https://bitbucket.org/tshepang/custom/src/tip/xsession">~/.xsession</a>):</p>
<pre style="background-color:#2b303b">
<span style="color:#c0c5ce;"># apps
</span><span style="color:#c0c5ce;">xfce4-terminal --hide-menubar --tab --tab --tab &amp;
</span><span style="color:#c0c5ce;">firefox &amp;
</span><span style="color:#c0c5ce;">nautilus --no-desktop &amp;
</span><span style="color:#c0c5ce;">nm-applet &amp;
</span><span style="color:#c0c5ce;">trayer --edge top --align right --widthtype request --distance 15 &amp;
</span><span style="color:#c0c5ce;">quodlibet &amp;
</span><span style="color:#c0c5ce;">if [ $HOSTNAME == &#39;twork&#39; ]; then
</span><span style="color:#c0c5ce;">   </span><span style="color:#c0c5ce;">icedove &amp;
</span><span style="color:#c0c5ce;">fi
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"># settings
</span><span style="color:#c0c5ce;">xset b off
</span><span style="color:#c0c5ce;">xmodmap -e &quot;clear Lock&quot;
</span><span style="color:#c0c5ce;">xmodmap -e &quot;keycode 66 = Super_L&quot;
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"># host-specific settings
</span><span style="color:#c0c5ce;">if [ $HOSTNAME == &#39;twork&#39; ]; then
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">xrandr --output VGA-0 --output DVI-0 --right-of VGA-0
</span><span style="color:#c0c5ce;">else
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">synclient TapButton1=1 TapButton2=3 TapButton3=2 MaxDoubleTapTime=100
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">syndaemon -dti 1
</span><span style="color:#c0c5ce;">fi
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"># clock
</span><span style="color:#c0c5ce;">while true; do
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">datetime=$( date +&quot;%F %R&quot; )
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">if acpi -a | grep off-line &gt; /dev/null; then
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">battery=$( python -c &quot;print(\&quot;$(acpi)\&quot;.split(&#39;,&#39;)[1].strip())&quot; )
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">xsetroot -name &quot;$battery&quot;&quot; | &quot;&quot;$datetime&quot;
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">else
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">xsetroot -name &quot;$datetime&quot;
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">fi
</span><span style="color:#c0c5ce;">    </span><span style="color:#c0c5ce;">sleep 1m
</span><span style="color:#c0c5ce;">done &amp;
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">exec dwm
</span></pre>
<p>Finally, this is what my dwm config changes look like (<a href="https://bitbucket.org/tshepang/custom/src/tip/config.def.h">config.def.h</a>):</p>
<pre style="background-color:#2b303b">
<span style="color:#c0c5ce;">diff --git a/config.def.h b/config.def.h
</span><span style="color:#c0c5ce;">index 77ff358..78af5d6 100644
</span><span style="color:#c0c5ce;">+++ a/config.def.h
</span><span style="color:#c0c5ce;">+++ b/config.def.h
</span><span style="color:#c0c5ce;">@@ -14,12 +14,15 @@ static const Bool showbar           = True;     /*
</span><span style="color:#c0c5ce;">False means no bar */
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">static const Bool topbar            = True;     /* False means bottom
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">bar */
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">/* tagging */
</span><span style="color:#c0c5ce;">-static const char *tags[] = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;,
</span><span style="color:#c0c5ce;">&quot;9&quot; };
</span><span style="color:#c0c5ce;">+static const char *tags[] = { &quot;web&quot;, &quot;files&quot;, &quot;terminal&quot;, &quot;misc&quot; };
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">static const Rule rules[] = {
</span><span style="color:#c0c5ce;">-       /* class      instance    title       tags mask     isfloating
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">monitor */
</span><span style="color:#c0c5ce;">-       { &quot;Gimp&quot;,     NULL,       NULL,       0,
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">True,        -1 },
</span><span style="color:#c0c5ce;">-       { &quot;Firefox&quot;,  NULL,       NULL,       1 &lt;&lt; 8,
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">False,       -1 },
</span><span style="color:#c0c5ce;">+  /* class             instance  title  tags mask  isfloating
</span><span style="color:#c0c5ce;">   </span><span style="color:#c0c5ce;">monitor */
</span><span style="color:#c0c5ce;">+  { &quot;Iceweasel&quot;,       NULL,     NULL,  1 &lt;&lt; 0,    False,       -1 },
</span><span style="color:#c0c5ce;">+  { &quot;trayer&quot;,          NULL,     NULL,  1 &lt;&lt; 0,    False,       -1 },
</span><span style="color:#c0c5ce;">+  { &quot;Nautilus&quot;,        NULL,     NULL,  1 &lt;&lt; 1,    False,       -1 },
</span><span style="color:#c0c5ce;">+  { &quot;Xfce4-terminal&quot;,  NULL,     NULL,  1 &lt;&lt; 2,    False,       -1 },
</span><span style="color:#c0c5ce;">+  { &quot;Quodlibet&quot;,       NULL,     NULL,  1 &lt;&lt; 3,    False,       -1 },
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">};
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">/* layout(s) */
</span><span style="color:#c0c5ce;">@@ -35,7 +38,7 @@ static const Layout layouts[] = {
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">};
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">/* key definitions */
</span><span style="color:#c0c5ce;">-#define MODKEY Mod1Mask
</span><span style="color:#c0c5ce;">+#define MODKEY Mod4Mask
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">#define TAGKEYS(KEY,TAG) \
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">{ MODKEY,                       KEY,      view,           {.ui
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">= 1 &lt;&lt; TAG} }, \
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">{ MODKEY|ControlMask,           KEY,      toggleview,     {.ui
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">= 1 &lt;&lt; TAG} }, \
</span><span style="color:#c0c5ce;">@@ -47,7 +50,7 @@ static const Layout layouts[] = {
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">/* commands */
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">static const char *dmenucmd[] = { &quot;dmenu_run&quot;, &quot;-fn&quot;, font, &quot;-nb&quot;,
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">normbgcolor, &quot;-nf&quot;, normfgcolor, &quot;-sb&quot;, selbgcolor, &quot;-sf&quot;,
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">selfgcolor, NULL };
</span><span style="color:#c0c5ce;">-static const char *termcmd[]  = { &quot;uxterm&quot;, NULL };
</span><span style="color:#c0c5ce;">+static const char *termcmd[]  = { &quot;xfce4-terminal&quot;, &quot;--hide-menubar&quot;
</span><span style="color:#c0c5ce;">};
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;"> </span><span style="color:#c0c5ce;">static Key keys[] = {
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">/* modifier                     key        function
</span><span style="color:#c0c5ce;">        </span><span style="color:#c0c5ce;">argument */
</span></pre>
<p>Note that this diff is against the Debian package (version <strong>6.0-6</strong>). I
could not change the modifier key with the upstream version of dwm.</p>
<p>You will notice that I'm still using one major GNOME package, Nautilus,
the file browser. It remains <a href="http://tshepang.net/favorite-floss">my favorite</a>.</p>

</div>

        </div>

    </body>

</html>
